/* * Inspired by: http://stackoverflow.com/questions/4360060/video-streaming-with-html-5-via-node-js */ var http = require('http'),    fs = require('fs'),    util = require('util'); http.createServer(function (req, res) {  var path = 'Zombieland.mp4';  var stat = fs.statSync(path);  var total = stat.size;  var sentSize;  var partialend = 0;  if (req.headers['range']) {    var range = req.headers.range;	console.log("Range: "+range);    var parts = range.replace(/bytes=/, "").split("-");    var partialstart = parts[0];    partialend = parts[1];	//partialend = partialstart+64000;	     var start = parseInt(partialstart, 10);	    var end = partialend ? parseInt(partialend, 10) : total-1;	//var end = start+(64*1024);    var chunksize = (end-start)+1;	//var chunksize = 64*1024;    console.log('RANGE: ' + start + ' - ' + end + ' = ' + chunksize+		", "+total+", "+partialstart+"/"+partialend);     var file = fs.createReadStream(path, {start: start, end: end});	//file throttle...	//var file = fs.createReadStream(path,  {'bufferSize': 64*1024});	// do stream .on data here...    res.writeHead(206, { 'Content-Range': 'bytes ' + start + '-' 		+ end + '/' + total, 'Accept-Ranges': 'bytes', 'Content-Length': chunksize, 		'Content-Type': 'video/mp4' });    file.pipe(res);  } else {    console.log('ALL: ' + total);    res.writeHead(200, { 'Content-Length': total, 'Content-Type': 'video/mp4' });    fs.createReadStream(path).pipe(res);  }}).listen(8080, '127.0.0.1');console.log('Server running at http://127.0.0.1:8080/');